

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>tmlib.datasets.base &mdash; topicmodel-lib 0.3.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="topicmodel-lib 0.3.1 documentation" href="../index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> topicmodel-lib
          

          
          </a>

          
            
            
              <div class="version">
                0.3.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quick_start.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick_start.html#corpus">Corpus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick_start.html#guide-to-learn-model">Guide to learn model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick_start.html#inference-for-new-documents">Inference for new documents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick_start.html#example">Example</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../lda_model.html">LDA Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../methods/online_vb.html">Online VB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../methods/online_cvb0.html">Online CVB0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../methods/online_cgs.html">Online CGS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../methods/online_fw.html">Online FW</a></li>
<li class="toctree-l1"><a class="reference internal" href="../methods/online_ope.html">Online OPE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../methods/streaming_vb.html">Streaming VB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../methods/streaming_fw.html">Streaming FW</a></li>
<li class="toctree-l1"><a class="reference internal" href="../methods/streaming_ope.html">Streaming OPE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../methods/ml_cgs.html">ML-CGS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../methods/ml_fw.html">ML-FW</a></li>
<li class="toctree-l1"><a class="reference internal" href="../methods/ml_ope.html">ML-OPE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../datasets.html">tmlib.datasets</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">topicmodel-lib</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>tmlib.datasets.base</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api/api_base.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="tmlib-datasets-base">
<h1><a class="toc-backref" href="#id3">tmlib.datasets.base</a><a class="headerlink" href="#tmlib-datasets-base" title="Permalink to this headline">¶</a></h1>
<p>This module includes some base classes and base functions which support for working with data input (corpus)</p>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#tmlib-datasets-base" id="id3">tmlib.datasets.base</a><ul>
<li><a class="reference internal" href="#class-tmlib-datasets-base-dataformat" id="id4">class tmlib.datasets.base.DataFormat</a><ul>
<li><a class="reference internal" href="#static-attributes" id="id5">Static Attributes</a></li>
<li><a class="reference internal" href="#example" id="id6">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#class-tmlib-datasets-base-corpus" id="id7">class tmlib.datasets.base.Corpus</a><ul>
<li><a class="reference internal" href="#parameters" id="id8">Parameters</a></li>
<li><a class="reference internal" href="#attributes" id="id9">Attributes</a></li>
<li><a class="reference internal" href="#methods" id="id10">Methods</a></li>
</ul>
</li>
<li><a class="reference internal" href="#class-tmlib-datasets-base-dataiterator" id="id11">class tmlib.datasets.base.DataIterator</a><ul>
<li><a class="reference internal" href="#id1" id="id12">Attributes</a></li>
<li><a class="reference internal" href="#id2" id="id13">Methods</a></li>
</ul>
</li>
<li><a class="reference internal" href="#function-base-get-data-home" id="id14">Function base.get_data_home</a></li>
<li><a class="reference internal" href="#function-base-clear-data-home" id="id15">Function base.clear_data_home</a></li>
<li><a class="reference internal" href="#function-base-check-input-format" id="id16">Function base.check_input_format</a></li>
<li><a class="reference internal" href="#function-base-load-batch-raw-text" id="id17">Function base.load_batch_raw_text</a></li>
<li><a class="reference internal" href="#function-base-pre-process" id="id18">Function base.pre_process</a></li>
<li><a class="reference internal" href="#function-base-load-batch-formatted-from-file" id="id19">Function base.load_batch_formatted_from_file</a></li>
<li><a class="reference internal" href="#function-base-reformat-file-to-term-sequence" id="id20">Function base.reformat_file_to_term_sequence</a></li>
<li><a class="reference internal" href="#function-base-reformat-file-to-term-frequency" id="id21">Function base.reformat_file_to_term_frequency</a></li>
<li><a class="reference internal" href="#function-base-convert-corpus-format" id="id22">Function base.convert_corpus_format</a></li>
<li><a class="reference internal" href="#function-base-load-mini-batch-term-sequence-from-sequence-file" id="id23">Function base.load_mini_batch_term_sequence_from_sequence_file</a></li>
<li><a class="reference internal" href="#function-base-load-mini-batch-term-sequence-from-term-frequency-file" id="id24">Function base.load_mini_batch_term_sequence_from_term_frequency_file</a></li>
<li><a class="reference internal" href="#function-base-load-mini-batch-term-frequency-from-sequence-file" id="id25">Function base.load_mini_batch_term_frequency_from_sequence_file</a></li>
<li><a class="reference internal" href="#function-base-load-mini-batch-term-frequency-from-term-frequency-file" id="id26">Function base.load_mini_batch_term_frequency_from_term_frequency_file</a></li>
<li><a class="reference internal" href="#function-shuffle-formatted-data-file" id="id27">Function shuffle_formatted_data_file</a></li>
<li><a class="reference internal" href="#function-base-compute-sparsity" id="id28">Function base.compute_sparsity</a></li>
<li><a class="reference internal" href="#function-base-write-topic-mixtures" id="id29">Function base.write_topic_mixtures</a></li>
<li><a class="reference internal" href="#function-base-read-vocab" id="id30">Function base.read_vocab</a></li>
<li><a class="reference internal" href="#function-base-parse-doc-list" id="id31">Function base.parse_doc_list</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="class-tmlib-datasets-base-dataformat">
<h2><a class="toc-backref" href="#id4">class tmlib.datasets.base.DataFormat</a><a class="headerlink" href="#class-tmlib-datasets-base-dataformat" title="Permalink to this headline">¶</a></h2>
<p>This is class which contains 3 <a class="reference external" href="../quick_start.rst#data-input-format">data-format</a> types of library is: raw text, term_sequence, term-frequency</p>
<div class="section" id="static-attributes">
<h3><a class="toc-backref" href="#id5">Static Attributes</a><a class="headerlink" href="#static-attributes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>RAW_TEXT</strong>: string, value is ‘txt’</li>
<li><strong>TERM_FREQUENCY</strong>: string, value is ‘tf’</li>
<li><strong>TERM_SEQUENCE</strong>: string, value is ‘sq’</li>
</ul>
</div>
<div class="section" id="example">
<h3><a class="toc-backref" href="#id6">Example</a><a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p>This example allows checking data format for: corpus <em>examples/ap/ap_train_raw.txt</em></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tmlib.datasets.base</span> <span class="k">import</span> <span class="n">DataFormat</span><span class="p">,</span> <span class="n">check_input_format</span>

<span class="n">input_format</span> <span class="o">=</span> <span class="n">check_input_format</span><span class="p">(</span><span class="s1">&#39;examples/ap/ap_train_raw.txt&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">input_format</span><span class="p">)</span>
<span class="k">if</span> <span class="n">input_format</span> <span class="o">==</span> <span class="n">DataFormat</span><span class="o">.</span><span class="n">RAW_TEXT</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Corpus is raw text&#39;</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">input_format</span> <span class="o">==</span> <span class="n">DataFormat</span><span class="o">.</span><span class="n">TERM_SEQUENCE</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Corpus is term-sequence format&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">Corpus</span> <span class="ow">is</span> <span class="n">term</span><span class="o">-</span><span class="n">frequency</span> <span class="nb">format</span><span class="s1">&#39;)</span>
</pre></div>
</div>
<p><strong>Output</strong>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">txt</span>
<span class="n">Corpus</span> <span class="ow">is</span> <span class="n">raw</span> <span class="n">text</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="class-tmlib-datasets-base-corpus">
<h2><a class="toc-backref" href="#id7">class tmlib.datasets.base.Corpus</a><a class="headerlink" href="#class-tmlib-datasets-base-corpus" title="Permalink to this headline">¶</a></h2>
<p>tmlib.datasets.base. <strong>Corpus</strong> (<em>format_type</em>)</p>
<p>This class is used to store the corpus with 2 formats: term-frequency and term-sequence</p>
<div class="section" id="parameters">
<h3><a class="toc-backref" href="#id8">Parameters</a><a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>format_type</strong>: DataFormat.TERM_SEQUENCE or DataFormat.TERM_FREQUENCY</li>
</ul>
</div>
<div class="section" id="attributes">
<h3><a class="toc-backref" href="#id9">Attributes</a><a class="headerlink" href="#attributes" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first"><strong>format_type</strong>: format of corpus</p>
</li>
<li><p class="first"><strong>word_ids_tks</strong>: list of list,</p>
<p>Each element in this list is a list which include the words of a document in corpus (words is unique terms if format is term-frequency and is list of tokens if format is term-sequence)</p>
</li>
<li><p class="first"><strong>cts_lens</strong>: list</p>
<p>if format is term-frequency, each element in list is a list frequency of unique terms in respectly document of corpus. If format is term-sequence, each element in list is the number of tokens in document (number of tokens in each doc).</p>
</li>
</ul>
</div>
<div class="section" id="methods">
<h3><a class="toc-backref" href="#id10">Methods</a><a class="headerlink" href="#methods" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first"><strong>append_doc</strong> (ids_tks, cts_lens)</p>
<p>Add a document to corpus. If format of this document is term-frequency, this method will append list of unique terms to <strong>word_ids_tks</strong> and append list of frequency to <strong>cts_lens</strong>. If format is term-sequence, the list of tokens and number of tokens will be appended respectly</p>
<ul>
<li><p class="first"><strong>Parameters</strong>: ids_tks and cts_lens is format (tf or sq) of added document</p>
<p><strong>ids_tks</strong>: list of unique terms (term-frequency format) or list of tokens (term-sequence format)
<strong>cts_lens</strong>: list of frequency of unique terms (term-frequency format) or number tokens in document (term-sequence format)</p>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="class-tmlib-datasets-base-dataiterator">
<h2><a class="toc-backref" href="#id11">class tmlib.datasets.base.DataIterator</a><a class="headerlink" href="#class-tmlib-datasets-base-dataiterator" title="Permalink to this headline">¶</a></h2>
<p>tmlib.datasets.base.DataIterator()</p>
<p>Abstract class is used for working with data input in learning LDA. Inherited by 2 class: <a class="reference external" href="./api_dataset.rst">tmlib.datasets.dataset.Dataset</a> and <a class="reference external" href="./api_wiki.rst">tmlib.datasets.wiki_stream.WikiStream</a></p>
<div class="section" id="id1">
<h3><a class="toc-backref" href="#id12">Attributes</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first"><strong>mini_batch_no</strong>: int,</p>
<p>Numerical order of mini-batch which used for learning at the present</p>
</li>
<li><p class="first"><strong>end_of_data</strong>: boolean,</p>
<p>To check the mini-batch is the last mini-batch or not</p>
</li>
</ul>
</div>
<div class="section" id="id2">
<h3><a class="toc-backref" href="#id13">Methods</a><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first"><strong>load_mini_batch</strong> ()</p>
<p>return a mini-batch sampled from corpus</p>
</li>
<li><p class="first"><strong>check_end_of_data</strong> ():</p>
<p>return value of <strong>end_of_data</strong> variable</p>
</li>
</ul>
</div>
</div>
<div class="section" id="function-base-get-data-home">
<h2><a class="toc-backref" href="#id14">Function base.get_data_home</a><a class="headerlink" href="#function-base-get-data-home" title="Permalink to this headline">¶</a></h2>
<p>tmlib.datasets.base. <strong>get_data_home</strong> (data_home=None)</p>
<p>This folder is used by some large dataset loaders to avoid downloading the data several times.</p>
<p>By default the data dir is set to a folder named ‘tmlib_data’ in the user home folder. We can change it by change value of data_home parameter
The ‘~’ symbol is expanded to the user home folder.</p>
<p>If the folder does not already exist, it is automatically created.</p>
<ul class="simple">
<li><strong>Return</strong>: path of the tmlib data dir.</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tmlib.datasets</span> <span class="k">import</span> <span class="n">base</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">base</span><span class="o">.</span><span class="n">get_data_home</span><span class="p">()</span>
<span class="go">/home/kde/tmlib_data</span>
</pre></div>
</div>
</div>
<div class="section" id="function-base-clear-data-home">
<h2><a class="toc-backref" href="#id15">Function base.clear_data_home</a><a class="headerlink" href="#function-base-clear-data-home" title="Permalink to this headline">¶</a></h2>
<p>tmlib.datasets.base. <strong>clear_data_home</strong> (data_home=None)</p>
<p>Delete all the content of the data home cache.</p>
</div>
<div class="section" id="function-base-check-input-format">
<h2><a class="toc-backref" href="#id16">Function base.check_input_format</a><a class="headerlink" href="#function-base-check-input-format" title="Permalink to this headline">¶</a></h2>
<p>tmlib.datasets.base.check_input_format(<em>file_path</em>)</p>
<ul>
<li><p class="first">Check format of input file(text formatted or raw text)</p>
</li>
<li><p class="first"><strong>Parameters</strong>: file_path (string)</p>
<p>Path of file input</p>
</li>
<li><p class="first"><strong>Return</strong>: format of input (DataFormat.RAW_TEXT, DataFormat.TERM_FREQUENCY or DataFormat.TERM_SEQUENCE)</p>
</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tmlib.datasets</span> <span class="k">import</span> <span class="n">base</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_path</span> <span class="o">=</span> <span class="s1">&#39;/home/kde/Desktop/topicmodel-lib/examples/ap/ap_train.txt&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">base</span><span class="o">.</span><span class="n">check_input_format</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
<span class="go">tf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_path</span> <span class="o">=</span> <span class="s1">&#39;/home/kde/Desktop/topicmodel-lib/examples/ap/ap_train_raw.txt&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">base</span><span class="o">.</span><span class="n">check_input_format</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
<span class="go">txt</span>
</pre></div>
</div>
</div>
<div class="section" id="function-base-load-batch-raw-text">
<h2><a class="toc-backref" href="#id17">Function base.load_batch_raw_text</a><a class="headerlink" href="#function-base-load-batch-raw-text" title="Permalink to this headline">¶</a></h2>
<p>tmlib.datasets.base.load_batch_raw_text(<em>file_raw_text_path</em>)</p>
<ul>
<li><p class="first">load all of documents and store as a list. Each element in this list is a document with raw text format (string)</p>
</li>
<li><p class="first"><strong>Parameters</strong>: file_raw_text_path (string)</p>
<p>Path of file input</p>
</li>
<li><p class="first"><strong>Return</strong>: list, each element in list is string type and also is text of a document</p>
</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tmlib.datasets</span> <span class="k">import</span> <span class="n">base</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path_file_raw_text</span> <span class="o">=</span> <span class="s1">&#39;/home/kde/Desktop/topicmodel-lib/examples/ap/ap_infer_raw.txt&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_docs</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">load_batch_raw_text</span><span class="p">(</span><span class="n">path_file_raw_text</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s1">&#39;number of documents: &#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_docs</span><span class="p">)</span>
<span class="go">number of documents:  50</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">list_docs</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
<span class="go"> Here is a summary of developments in forest and brush fires in Western states:</span>
</pre></div>
</div>
</div>
<div class="section" id="function-base-pre-process">
<h2><a class="toc-backref" href="#id18">Function base.pre_process</a><a class="headerlink" href="#function-base-pre-process" title="Permalink to this headline">¶</a></h2>
<p>tmlib.datasets.base.pre_process(<em>file_path</em>)</p>
<ul>
<li><p class="first">Preprocessing for file input if format of data is raw text</p>
</li>
<li><p class="first"><strong>Paremeter</strong>: file_path (string)</p>
<p>Path of file input</p>
</li>
<li><p class="first"><strong>Return</strong>: list which respectly includes path of vocabulary file, term-frequency file, term-sequence file after preprocessing</p>
</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tmlib.datasets</span> <span class="k">import</span> <span class="n">base</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path_file</span> <span class="o">=</span> <span class="s1">&#39;/home/kde/Desktop/topicmodel-lib/examples/ap/ap_train_raw.txt&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path_vocab</span><span class="p">,</span> <span class="n">path_tf</span><span class="p">,</span> <span class="n">path_sq</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">pre_process</span><span class="p">(</span><span class="n">path_file</span><span class="p">)</span>
<span class="go">Waiting...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s1">&#39;path to file vocabulary extracted: &#39;</span><span class="p">,</span> <span class="n">path_vocab</span>
<span class="go">path to file vocabulary extracted:  /home/kde/tmlib_data/ap_train_raw/vocab.txt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s1">&#39;path to file with term-frequency format: &#39;</span><span class="p">,</span> <span class="n">path_tf</span>
<span class="go">path to file with term-frequency format:  /home/kde/tmlib_data/ap_train_raw/ap_train_raw.tf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s1">&#39;path to file with term-sequence format: &#39;</span><span class="p">,</span> <span class="n">path_sq</span>
<span class="go">path to file with term-sequence format:  /home/kde/tmlib_data/ap_train_raw/ap_train_raw.sq</span>
</pre></div>
</div>
</div>
<div class="section" id="function-base-load-batch-formatted-from-file">
<h2><a class="toc-backref" href="#id19">Function base.load_batch_formatted_from_file</a><a class="headerlink" href="#function-base-load-batch-formatted-from-file" title="Permalink to this headline">¶</a></h2>
<p>tmlib.datasets.base.load_batch_formatted_from_file(<em>data_path, output_format=DataFormat.TERM_FREQUENCY</em>)</p>
<ul class="simple">
<li>load all of documents in file which is formatted as term-frequency format or term-sequence format and return a corpus with format is <strong>output_format</strong></li>
<li><strong>Parameters</strong>:<ul>
<li><strong>data_path</strong>: path of file data input which is formatted</li>
<li><strong>output_format</strong>: format data of output, default: term-frequence format</li>
</ul>
</li>
<li><strong>Return</strong>: object corpus which is the data input for learning</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">path_file_tf</span> <span class="o">=</span> <span class="s1">&#39;/home/kde/Desktop/topicmodel-lib/examples/ap/ap_train.txt&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">corpus_tf</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">load_batch_formatted_from_file</span><span class="p">(</span><span class="n">path_file_tf</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s1">&#39;Unique terms in the 9th documents: &#39;</span><span class="p">,</span> <span class="n">corpus_tf</span><span class="o">.</span><span class="n">word_ids_tks</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
<span class="go">Unique terms in the 9th documents:  [5829 4040 2891   14 1783  381 2693]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s1">&#39;Frequency of unique terms in the 9th documents: &#39;</span><span class="p">,</span> <span class="n">corpus_tf</span><span class="o">.</span><span class="n">cts_lens</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
<span class="go">Frequency of unique terms in the 9th documents:  [1 1 1 1 1 1 1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">corpus_sq</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">load_batch_formatted_from_file</span><span class="p">(</span><span class="n">path_file_tf</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="n">base</span><span class="o">.</span><span class="n">DataFormat</span><span class="o">.</span><span class="n">TERM_SEQUENCE</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s1">&#39;List of tokens in the 9th documents: &#39;</span><span class="p">,</span> <span class="n">corpus_sq</span><span class="o">.</span><span class="n">word_ids_tks</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
<span class="go">List of tokens in the 9th documents:  [5829 4040 2891   14 1783  381 2693]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s1">&#39;Number of tokens in the 9th document: &#39;</span><span class="p">,</span> <span class="n">corpus_sq</span><span class="o">.</span><span class="n">cts_lens</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
<span class="go">Number of tokens in the 9th document:  7</span>
</pre></div>
</div>
</div>
<div class="section" id="function-base-reformat-file-to-term-sequence">
<h2><a class="toc-backref" href="#id20">Function base.reformat_file_to_term_sequence</a><a class="headerlink" href="#function-base-reformat-file-to-term-sequence" title="Permalink to this headline">¶</a></h2>
<p>tmlib.datasets.base.reformat_file_to_term_sequence(<em>file_path</em>)</p>
<ul>
<li><p class="first">convert the formatted file input (tf or sq) to file with format term-sequence</p>
</li>
<li><p class="first"><strong>Parameter</strong>: file_path (string)</p>
<p>Path of file input</p>
</li>
<li><p class="first"><strong>Return</strong>: path of file which is formatted to term-sequence</p>
</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tmlib.datasets</span> <span class="k">import</span> <span class="n">base</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path_file_tf</span> <span class="o">=</span> <span class="n">tmlib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path_file_sq</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">reformat_file_to_term_sequence</span><span class="p">(</span><span class="n">path_file_tf</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s1">&#39;path to file term-sequence: &#39;</span><span class="p">,</span> <span class="n">path_file_sq</span>
<span class="go">path to file term-sequence:  /home/kde/tmlib_data/ap_train/ap_train.sq</span>
</pre></div>
</div>
</div>
<div class="section" id="function-base-reformat-file-to-term-frequency">
<h2><a class="toc-backref" href="#id21">Function base.reformat_file_to_term_frequency</a><a class="headerlink" href="#function-base-reformat-file-to-term-frequency" title="Permalink to this headline">¶</a></h2>
<p>tmlib.datasets.base.reformat_file_to_term_sequence(<em>file_path</em>)</p>
<ul>
<li><p class="first">convert the formatted file input (tf or sq) to file with format term-frequency</p>
</li>
<li><p class="first"><strong>Parameter</strong>: file_path (string)</p>
<p>Path of file input</p>
</li>
<li><p class="first"><strong>Return</strong>: path of file which is formatted to term-frequency</p>
</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tmlib.datasets</span> <span class="k">import</span> <span class="n">base</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path_file</span> <span class="o">=</span> <span class="s1">&#39;/home/kde/Desktop/topicmodel-lib/examples/ap/ap_train.txt&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path_file_tf</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">reformat_file_to_term_sequence</span><span class="p">(</span><span class="n">path_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s1">&#39;path to file term-frequency: &#39;</span><span class="p">,</span> <span class="n">path_file_tf</span>
<span class="go">path to file term-frequency:  /home/kde/tmlib_data/ap_train/ap_train.tf</span>
</pre></div>
</div>
</div>
<div class="section" id="function-base-convert-corpus-format">
<h2><a class="toc-backref" href="#id22">Function base.convert_corpus_format</a><a class="headerlink" href="#function-base-convert-corpus-format" title="Permalink to this headline">¶</a></h2>
<p>tmlib.datasets.base.convert_corpus_format(<em>corpus, data_format</em>)</p>
<ul class="simple">
<li>convert corpus (object of class Corpus) to desired format</li>
<li><strong>Parameters</strong>:<ul>
<li><strong>corpus</strong>: object of class Corpus,</li>
<li><strong>data_format</strong>: format type desired (DataFormat.TERM_SEQUENCE or DataFormat.TERM_FREQUENCY)</li>
</ul>
</li>
<li><strong>Return</strong>: object corpus with desired format</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tmlib.datasets</span> <span class="k">import</span> <span class="n">base</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path_file_tf</span> <span class="o">=</span> <span class="s1">&#39;/home/kde/Desktop/topicmodel-lib/examples/ap/ap_train.txt&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">corpus</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">load_batch_formatted_from_file</span><span class="p">(</span><span class="n">path_file_tf</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">corpus_sq</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">convert_corpus_format</span><span class="p">(</span><span class="n">corpus</span><span class="p">,</span> <span class="n">base</span><span class="o">.</span><span class="n">DataFormat</span><span class="o">.</span><span class="n">TERM_SEQUENCE</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s1">&#39;Unique terms in the 22th documents: &#39;</span><span class="p">,</span> <span class="n">corpus</span><span class="o">.</span><span class="n">word_ids_tks</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span>
<span class="go">Unique terms in the 22th documents:  [  32  396  246   87  824 3259  316  285]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s1">&#39;Frequency of unique terms in the 22th documents: &#39;</span><span class="p">,</span> <span class="n">corpus</span><span class="o">.</span><span class="n">cts_lens</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span>
<span class="go">Frequency of unique terms in the 22th documents:  [1 1 1 2 1 1 2 1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s1">&#39;List of tokens in the 22th documents: &#39;</span><span class="p">,</span> <span class="n">corpus_sq</span><span class="o">.</span><span class="n">word_ids_tks</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span>
<span class="go">List of tokens in the 22th documents:  [32, 396, 246, 87, 87, 824, 3259, 316, 316, 285]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s1">&#39;Number of tokens in the 22th document: &#39;</span><span class="p">,</span> <span class="n">corpus_sq</span><span class="o">.</span><span class="n">cts_lens</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span>
<span class="go">Number of tokens in the 22th document:  10</span>
</pre></div>
</div>
</div>
<div class="section" id="function-base-load-mini-batch-term-sequence-from-sequence-file">
<h2><a class="toc-backref" href="#id23">Function base.load_mini_batch_term_sequence_from_sequence_file</a><a class="headerlink" href="#function-base-load-mini-batch-term-sequence-from-sequence-file" title="Permalink to this headline">¶</a></h2>
<p>tmlib.datasets.base.load_mini_batch_term_sequence_from_sequence_file(<em>fp, batch_size</em>)</p>
<ul class="simple">
<li>loading a mini-batch with size: <strong>batch_size</strong> from a file which has the file pointer <strong>fp</strong>. This file includes the documents with term-sequence format and the loaded mini-batch is also term-sequence format</li>
<li><strong>Parameter</strong>:<ul>
<li><strong>fp</strong>: file pointer of file term-sequence format</li>
<li><strong>batch_size</strong>: int, size of mini-batch</li>
</ul>
</li>
<li><strong>Return</strong>: <em>(minibatch, end_file)</em>. <em>minibatch</em> is object of class Corpus with term-sequence format and <em>end_file</em> is boolean variable which check that file pointer is at end of file or not</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tmlib.datasets</span> <span class="k">import</span> <span class="n">base</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path_file_tf</span> <span class="o">=</span> <span class="s1">&#39;/home/kde/Desktop/topicmodel-lib/examples/ap/ap_train.txt&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path_file_sq</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">reformat_file_to_term_sequence</span><span class="p">(</span><span class="n">path_file_tf</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_file_sq</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mini_batch</span><span class="p">,</span> <span class="n">end_file</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">load_mini_batch_term_sequence_from_sequence_file</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="mi">1500</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s1">&#39;Format of mini_batch: &#39;</span><span class="p">,</span> <span class="n">mini_batch</span><span class="o">.</span><span class="n">format_type</span>
<span class="go">Format of mini_batch:  sq</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s1">&#39;List of tokens in the first document of mini_batch: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">mini_batch</span><span class="o">.</span><span class="n">word_ids_tks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">List of tokens in the first document of mini_batch:</span>
<span class="go">[    0  6144  3586  3586     3     4  1541     8    10  3927    12    12</span>
<span class="go">    12    12    12    12    12  4621   527  9232  1112  1112    20  2587</span>
<span class="go">  6172 10269 10269    37    42  3117  1582  1585  1585  1585   435  9268</span>
<span class="go">  9268  9268   571   571    60    61    63    63    64    64  5185    11</span>
<span class="go">  4683   590   590  1103  1103   592  5718  1623  1623  1624  1624  1624</span>
<span class="go">  1624    89    89  6234  8802  1638   103   600  9404   106  3691   720</span>
<span class="go">  2672   113  2165  5751   123   123   123  1148   128   128  1670  1670</span>
<span class="go">  4231  1167   144   147   149   149   149   149   149   149   149  3735</span>
<span class="go">  3735  5272  5272  1732   673   673  5282    27  1700  9893  9893   166</span>
<span class="go">   167   173   174  2224  2248   372   372   186  4284  4284  4284  3450</span>
<span class="go">  3450   117   117   203  2244  5320   201  4215  9932  9932   207   207</span>
<span class="go">   208   208   208   208   208  8914  7898   733   733  1760  1744   744</span>
<span class="go">   234  1259  1259  4287  7254   249  8311  5884  5884   298   254   767</span>
<span class="go">   767  2304  4876   270   557   786   789   789  2331   287  5409   290</span>
<span class="go">  5923  2854  1834  1834  1834   303  3888  3888  3888  3888   817   817</span>
<span class="go">  9523   334  1333   311   311  1855  1417   325  1870  1870  1870  1870</span>
<span class="go">  1870  1870  1870  1361  1362  6995   342   343   344   857  5469  5469</span>
<span class="go">   351   351   351   351   351  1377  2402   487   884   885   890  4477</span>
<span class="go">  3455  1410  5099  4489   395  2570   152   404  1429  1430  3992   416</span>
<span class="go">  3491  2033  3499   429  3502  5040   433   433  1971  1971  1971  1971</span>
<span class="go">   437  9667  9667   322  7119  8656  1102   985   989  1840  2529   997</span>
<span class="go">  2022  2022  4071  2536 10219  1517  1009   221  3059   500   511]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s1">&#39;Number of tokens in the first document of mini_batch: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">mini_batch</span><span class="o">.</span><span class="n">cts_lens</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Number of tokens in the first document of mini_batch:</span>
<span class="go">263</span>
</pre></div>
</div>
</div>
<div class="section" id="function-base-load-mini-batch-term-sequence-from-term-frequency-file">
<h2><a class="toc-backref" href="#id24">Function base.load_mini_batch_term_sequence_from_term_frequency_file</a><a class="headerlink" href="#function-base-load-mini-batch-term-sequence-from-term-frequency-file" title="Permalink to this headline">¶</a></h2>
<p>tmlib.datasets.base.load_mini_batch_term_sequence_from_term_frequency_file(<em>fp, batch_size</em>)</p>
<ul class="simple">
<li>loading a mini-batch with size: <strong>batch_size</strong> from a file which has the file pointer <strong>fp</strong>. This file includes the documents with term-frequency format and the returned mini-batch is term-sequence format</li>
<li><strong>Parameter</strong>:<ul>
<li><strong>fp</strong>: file pointer of file term-frequency format</li>
<li><strong>batch_size</strong>: int, size of mini-batch</li>
</ul>
</li>
<li><strong>Return</strong>: <em>(minibatch, end_file)</em>. <em>minibatch</em> is object of class Corpus with term-sequence format and <em>end_file</em> is boolean variable which check that file pointer is at end of file or not</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tmlib.datasets</span> <span class="k">import</span> <span class="n">base</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path_file_tf</span> <span class="o">=</span> <span class="s1">&#39;/home/kde/Desktop/topicmodel-lib/examples/ap/ap_train.txt&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_file_tf</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mini_batch1</span><span class="p">,</span> <span class="n">end_file</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">load_mini_batch_term_sequence_from_term_frequency_file</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="mi">1500</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s1">&#39;Format of mini_batch1: &#39;</span><span class="p">,</span> <span class="n">mini_batch1</span><span class="o">.</span><span class="n">format_type</span>
<span class="go">Format of mini_batch1:  sq</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s1">&#39;Size of mini_batch1: &#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">mini_batch1</span><span class="o">.</span><span class="n">word_ids_tks</span><span class="p">)</span>
<span class="go">Size of mini_batch1:  1500</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s1">&#39;End file: &#39;</span><span class="p">,</span> <span class="n">end_file</span>
<span class="go">End file:  False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mini_batch2</span><span class="p">,</span> <span class="n">end_file</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">load_mini_batch_term_sequence_from_term_frequency_file</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="mi">1500</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s1">&#39;Size of mini_batch2: &#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">mini_batch2</span><span class="o">.</span><span class="n">word_ids_tks</span><span class="p">)</span>
<span class="go">Size of mini_batch2:  700</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s1">&#39;End file: &#39;</span><span class="p">,</span> <span class="n">end_file</span>
<span class="go">End file:  True</span>
</pre></div>
</div>
</div>
<div class="section" id="function-base-load-mini-batch-term-frequency-from-sequence-file">
<h2><a class="toc-backref" href="#id25">Function base.load_mini_batch_term_frequency_from_sequence_file</a><a class="headerlink" href="#function-base-load-mini-batch-term-frequency-from-sequence-file" title="Permalink to this headline">¶</a></h2>
<p>tmlib.datasets.base.load_mini_batch_term_frequency_from_sequence_file(<em>fp, batch_size</em>)</p>
<ul class="simple">
<li>loading a mini-batch with size: <strong>batch_size</strong> from a file which has the file pointer <strong>fp</strong>. This file includes the documents with term-sequence format and the returned mini-batch is term-frequency format</li>
<li><strong>Parameter</strong>:<ul>
<li><strong>fp</strong>: file pointer of file term-sequence format</li>
<li><strong>batch_size</strong>: int, size of mini-batch</li>
</ul>
</li>
<li><strong>Return</strong>: <em>(minibatch, end_file)</em>. <em>minibatch</em> is object of class Corpus with term-frequency format and <em>end_file</em> is boolean variable which check that file pointer is at end of file or not</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tmlib.datasets</span> <span class="k">import</span> <span class="n">base</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path_file_tf</span> <span class="o">=</span> <span class="s1">&#39;/home/kde/Desktop/topicmodel-lib/examples/ap/ap_train.txt&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path_file_sq</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">reformat_file_to_term_sequence</span><span class="p">(</span><span class="n">path_file_tf</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_file_sq</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mini_batch</span><span class="p">,</span> <span class="n">end_file</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">load_mini_batch_term_frequency_from_sequence_file</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="mi">1500</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s1">&#39;Format of mini_batch: &#39;</span><span class="p">,</span> <span class="n">mini_batch</span><span class="o">.</span><span class="n">format_type</span>
<span class="go">Format of mini_batch:  tf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s1">&#39;Unique terms in the first document of mini_batch: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">mini_batch</span><span class="o">.</span><span class="n">word_ids_tks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Unique terms in the first document of mini_batch:</span>
<span class="go">[    0  6144  3586     3     4  1541     8    10    11    12  4621   527</span>
<span class="go">  9232  1112    20  2587  6172 10269    37    42  3117  1582  1585  1971</span>
<span class="go">  9268   571    60    61    63    64  5185   343  4683   590  1103   592</span>
<span class="go">  5718  1623  1624    89  6234  8802  1638   103   600  9404   106  3691</span>
<span class="go">   890  2672   113  2165  4215   123  1148   128  1670  4231  1167   144</span>
<span class="go">   147   149  3735  5272  1732  1744  4489   673  5282    27  1700  9893</span>
<span class="go">   166   167  5751   173   174  2224  2248   884   186  4284   117  2244</span>
<span class="go">  5320   201   203  9932   207   720  8914  7898   733  1760   208   744</span>
<span class="go">   234  1259  4287   249  8311  7254  1834   254   767  2304  4876   270</span>
<span class="go">   557   786   789  2331   287  5409   290  5923  2854   298   303  3888</span>
<span class="go">   817  9523  1333   311  1855   322   325  1102   334  1361  1362  6995</span>
<span class="go">   342  3927   344   857  5469   351  1377  2402  4071   372   885  3450</span>
<span class="go">  4477  3455  1410 10219  1417   395  2570   152   404  1429  1430  3992</span>
<span class="go">   416  3491  1009  3499   429  3502  5040   433   435   437  9667  7119</span>
<span class="go">  8656  1870   985   989  1840  2529   997  2022   487  2536  5884  5099</span>
<span class="go">  1517  2033   221  3059   500   511]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s1">&#39;Frequency of unique terms in the first document of mini_batch: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">mini_batch</span><span class="o">.</span><span class="n">cts_lens</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Frequency of unique terms in the first document of mini_batch:</span>
<span class="go">[1 1 2 1 1 1 1 1 1 7 1 1 1 2 1 1 1 2 1 1 1 1 3 4 3 2 1 1 2 2 1 1 1 2 2 1 1</span>
<span class="go"> 2 4 2 1 1 1 1 1 1 1 1 1 1 1 1 1 3 1 2 2 1 1 1 1 7 2 2 1 1 1 2 1 1 1 2 1 1</span>
<span class="go"> 1 1 1 1 1 1 1 3 2 1 1 1 1 2 2 1 1 1 2 1 5 1 1 2 1 1 1 1 3 1 2 1 1 1 1 1 2</span>
<span class="go"> 1 1 1 1 1 1 1 1 4 2 1 1 2 1 1 1 1 1 1 1 1 1 1 1 1 2 5 1 1 1 2 1 2 1 1 1 1</span>
<span class="go"> 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 1 1 2 1 1 7 1 1 1 1 1 2 1 1 2 1 1 1 1 1 1</span>
<span class="go"> 1]</span>
</pre></div>
</div>
</div>
<div class="section" id="function-base-load-mini-batch-term-frequency-from-term-frequency-file">
<h2><a class="toc-backref" href="#id26">Function base.load_mini_batch_term_frequency_from_term_frequency_file</a><a class="headerlink" href="#function-base-load-mini-batch-term-frequency-from-term-frequency-file" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>loading a mini-batch with size: <strong>batch_size</strong> from a file which has the file pointer <strong>fp</strong>. This file includes the documents with term-frequency format and the returned mini-batch is also term-frequency format</li>
<li><strong>Parameter</strong>:<ul>
<li><strong>fp</strong>: file pointer of file term-frequency format</li>
<li><strong>batch_size</strong>: int, size of mini-batch</li>
</ul>
</li>
<li><strong>Return</strong>: <em>(minibatch, end_file)</em>. <em>minibatch</em> is object of class Corpus with term-frequency format and <em>end_file</em> is boolean variable which check that file pointer is at end of file or not</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tmlib.datasets</span> <span class="k">import</span> <span class="n">base</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path_file_tf</span> <span class="o">=</span> <span class="s1">&#39;/home/kde/Desktop/topicmodel-lib/examples/ap/ap_train.txt&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_file_tf</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mini_batch</span><span class="p">,</span> <span class="n">end_file</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">load_mini_batch_term_frequency_from_term_frequency_file</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="mi">1500</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s1">&#39;Format of mini_batch: &#39;</span><span class="p">,</span> <span class="n">mini_batch</span><span class="o">.</span><span class="n">format_type</span>
<span class="go">Format of mini_batch:  tf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s1">&#39;Unique terms in the first document of mini_batch: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">mini_batch</span><span class="o">.</span><span class="n">word_ids_tks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Unique terms in the first document of mini_batch:</span>
<span class="go">[    0  6144  3586     3     4  1541     8    10  3927    12  4621   527</span>
<span class="go">  9232  1112    20  2587  6172 10269    37    42  3117  1582  1585   435</span>
<span class="go">  9268   571    60    61    63    64  5185    11  4683   590  1103   592</span>
<span class="go">  5718  1623  1624    89  6234  8802  1638   103   600  9404   106  3691</span>
<span class="go">   720  2672   113  2165  5751   123  1148   128  1670  4231  1167   144</span>
<span class="go">   147   149  3735  5272  1732   673  5282    27  1700  9893   166   167</span>
<span class="go">   173   174  2224  2248   372   186  4284  3450   117   203  2244  5320</span>
<span class="go">   201  4215  9932   207   208  8914  7898   733  1760  1744   744   234</span>
<span class="go">  1259  4287  7254   249  8311  5884   298   254   767  2304  4876   270</span>
<span class="go">   557   786   789  2331   287  5409   290  5923  2854  1834   303  3888</span>
<span class="go">   817  9523   334  1333   311  1855  1417   325  1870  1361  1362  6995</span>
<span class="go">   342   343   344   857  5469   351  1377  2402   487   884   885   890</span>
<span class="go">  4477  3455  1410  5099  4489   395  2570   152   404  1429  1430  3992</span>
<span class="go">   416  3491  2033  3499   429  3502  5040   433  1971   437  9667   322</span>
<span class="go">  7119  8656  1102   985   989  1840  2529   997  2022  4071  2536 10219</span>
<span class="go">  1517  1009   221  3059   500   511]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s1">&#39;Frequency of unique terms in the first document of mini_batch: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">mini_batch</span><span class="o">.</span><span class="n">cts_lens</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Frequency of unique terms in the first document of mini_batch:</span>
<span class="go">[1 1 2 1 1 1 1 1 1 7 1 1 1 2 1 1 1 2 1 1 1 1 3 1 3 2 1 1 2 2 1 1 1 2 2 1 1</span>
<span class="go"> 2 4 2 1 1 1 1 1 1 1 1 1 1 1 1 1 3 1 2 2 1 1 1 1 7 2 2 1 2 1 1 1 2 1 1 1 1</span>
<span class="go"> 1 1 2 1 3 2 2 1 1 1 1 1 2 2 5 1 1 2 1 1 1 1 2 1 1 1 1 2 1 1 2 1 1 1 1 1 2</span>
<span class="go"> 1 1 1 1 1 1 3 1 4 2 1 1 1 2 1 1 1 7 1 1 1 1 1 1 1 2 5 1 1 1 1 1 1 1 1 1 1</span>
<span class="go"> 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 4 1 2 1 1 1 1 1 1 1 1 1 2 1 1 1 1 1 1 1 1</span>
<span class="go"> 1]</span>
</pre></div>
</div>
</div>
<div class="section" id="function-shuffle-formatted-data-file">
<h2><a class="toc-backref" href="#id27">Function shuffle_formatted_data_file</a><a class="headerlink" href="#function-shuffle-formatted-data-file" title="Permalink to this headline">¶</a></h2>
<p>tmlib.datasets.base.shuffle_formatted_data_file(<em>data_path, batch_size</em>)</p>
<ul class="simple">
<li>Random permutation of all documents in file input. Because the learning methods are stochastic, so this fuction help sample randomly mini-batch from corpus. And after shuffling, the documents with new position will be written to a new file.</li>
<li><strong>Parameter</strong>:<ul>
<li><strong>data_path</strong>: file input which is formatted (tf or sq)</li>
<li><strong>batch_size</strong>: the necessary parameter for the shuffling algorithm designed by us</li>
</ul>
</li>
<li><strong>Return</strong>: path of new file which is shuffled</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tmlib.datasets</span> <span class="k">import</span> <span class="n">base</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path_file</span> <span class="o">=</span> <span class="s1">&#39;/home/kde/Desktop/topicmodel-lib/examples/ap/ap_train.txt&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path_file_shuffled</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">shuffle_formatted_data_file</span><span class="p">(</span><span class="n">path_file</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s1">&#39;Path to file shuffled: &#39;</span><span class="p">,</span> <span class="n">path_file_shuffled</span>
<span class="go">Path to file shuffled:  /home/kde/Desktop/topicmodel-lib/examples/ap/ap_train.txt.shuffled</span>
</pre></div>
</div>
</div>
<div class="section" id="function-base-compute-sparsity">
<h2><a class="toc-backref" href="#id28">Function base.compute_sparsity</a><a class="headerlink" href="#function-base-compute-sparsity" title="Permalink to this headline">¶</a></h2>
<p>tmlib.datasets.base.compute_sparsity(<em>doc_tp, num_docs, num_topics, _type</em>)</p>
<ul class="simple">
<li>Compute document sparsity.</li>
<li><strong>Parameters</strong>:<ul>
<li><strong>doc_tp</strong>: numpy.array, 2-dimention, the estimated topic mixtures of all documents in corpus</li>
<li><strong>num_docs</strong>: int, the number of documents in corpus</li>
<li><strong>num_topics</strong>: int, is the number of requested latent topics to be extracted from the training corpus.</li>
<li><strong>_type</strong>: string, if the value is ‘z’, the topic mixtures is estimated by the sampling method as CGS or CVB0, so we have the individual caculation for this. Otherwise, if the value of it isn’t ‘z’, this is for the methods as: VB, OPE or FW</li>
</ul>
</li>
<li><strong>Return</strong>: float, sparsity of documents</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tmlib.datasets</span> <span class="k">import</span> <span class="n">base</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base</span><span class="o">.</span><span class="n">compute_sparsity</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">theta</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">theta</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">_type</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="go">1.0</span>
</pre></div>
</div>
</div>
<div class="section" id="function-base-write-topic-mixtures">
<h2><a class="toc-backref" href="#id29">Function base.write_topic_mixtures</a><a class="headerlink" href="#function-base-write-topic-mixtures" title="Permalink to this headline">¶</a></h2>
<p>tmlib.datasets.base.write_topic_mixtures(<em>theta, file_name</em>)</p>
<ul class="simple">
<li>save topic mixtures (theta) to a file</li>
<li><strong>Parameters</strong>:<ul>
<li><strong>theta</strong>: numpy.array, 2-dimention</li>
<li><strong>file_name</strong>: name (path) of file which is written</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="function-base-read-vocab">
<h2><a class="toc-backref" href="#id30">Function base.read_vocab</a><a class="headerlink" href="#function-base-read-vocab" title="Permalink to this headline">¶</a></h2>
<p>tmlib.datasets.base. <strong>read_vocab</strong> (<em>path_vocab</em>)</p>
<ul class="simple">
<li>Read file vocabulary and store it with dictionary type of python (for example: the word ‘hello’ is the 2nd word (index = 2) in file vocabulary, this function return a object named <em>dict</em>, we have: dict[‘hello’] = 2), it’s used as input parameter for function <strong>parse_doc_list</strong></li>
<li><strong>Parameters</strong>:<ul>
<li><strong>path_vocab</strong>: path of file vocabulary</li>
</ul>
</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tmlib.datasets</span> <span class="k">import</span> <span class="n">base</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path_vocab</span> <span class="o">=</span> <span class="s1">&#39;/home/kde/Desktop/topicmodel-lib/examples/ap/vocab.txt&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_unique_terms</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_vocab</span><span class="p">)</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_unique_terms</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="go">&#39;years&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dict_vocab</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">read_vocab</span><span class="p">(</span><span class="n">path_vocab</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dict_vocab</span><span class="p">[</span><span class="s1">&#39;years&#39;</span><span class="p">]</span>
<span class="go">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_unique_terms</span><span class="p">[</span><span class="mi">1021</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="go">&#39;laws&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dict_vocab</span><span class="p">[</span><span class="s1">&#39;laws&#39;</span><span class="p">]</span>
<span class="go">1021</span>
</pre></div>
</div>
</div>
<div class="section" id="function-base-parse-doc-list">
<h2><a class="toc-backref" href="#id31">Function base.parse_doc_list</a><a class="headerlink" href="#function-base-parse-doc-list" title="Permalink to this headline">¶</a></h2>
<p>tmlib.datasets.base. <strong>parse_doc_list</strong> (<em>docs, vocab_dict</em>)</p>
<ul class="simple">
<li><strong>Parameters</strong>:<ul>
<li><strong>docs</strong>: list of document. Each document is represented as a string of words (same as raw text)</li>
<li><strong>vocab_dict</strong>: vocabulary is represented as dictionary format described above</li>
</ul>
</li>
<li><strong>Return</strong>: object of class Corpus</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">path_vocab</span> <span class="o">=</span> <span class="s1">&#39;/home/kde/Desktop/topicmodel-lib/examples/ap/vocab.txt&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dict_vocab</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">read_vocab</span><span class="p">(</span><span class="n">path_vocab</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path_file_raw_text</span> <span class="o">=</span> <span class="s1">&#39;/home/kde/Desktop/topicmodel-lib/examples/ap/ap_infer_raw.txt&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_docs</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">load_batch_raw_text</span><span class="p">(</span><span class="n">path_file_raw_text</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s1">&#39;The 9th document has the content: &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span><span class="n">list_docs</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
<span class="go">The 9th document has the content: &quot; Here is a summary of developments in forest and brush fires in Western states:&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">corpus_tf</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">parse_doc_list</span><span class="p">(</span><span class="n">list_docs</span><span class="p">,</span> <span class="n">dict_vocab</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_unique_terms</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_vocab</span><span class="p">)</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_terms_in_doc_9th</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">corpus_tf</span><span class="o">.</span><span class="n">word_ids_tks</span><span class="p">[</span><span class="mi">8</span><span class="p">]:</span> \
<span class="gp">... </span>    <span class="n">list_terms_in_doc_9th</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">list_unique_terms</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s1">&#39;List of unique terms in the 9th document: &#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">indexs: &#39;</span><span class="p">,</span> <span class="n">corpus_tf</span><span class="o">.</span><span class="n">word_ids_tks</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">words: &#39;</span><span class="p">,</span> <span class="n">list_terms_in_doc_9th</span>
<span class="go">List of unique terms in the 9th document:</span>
<span class="go">indexs:  [5829, 4040, 2891, 14, 1783, 381, 2693]</span>
<span class="go">words:  [&#39;summary&#39;, &#39;brush&#39;, &#39;fires&#39;, &#39;states&#39;, &#39;forest&#39;, &#39;western&#39;, &#39;developments&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s1">&#39;Frequency of unique terms: &#39;</span><span class="p">,</span> <span class="n">corpus_tf</span><span class="o">.</span><span class="n">cts_lens</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
<span class="go">Frequency of unique terms:  [1, 1, 1, 1, 1, 1, 1]</span>
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, DSLab.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.3.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>